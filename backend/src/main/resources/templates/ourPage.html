<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html"
      xmlns:security="http://www.springframework.org/schema/security">


<head>
    <title>Our application</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <script src="../js/jquery.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/css/dropzone.css">
    <link rel="stylesheet" href="/css/jquery.simplecolorpicker.css">
    <link rel="stylesheet" href="/css/jquery.simplecolorpicker-regularfont.css">
    <link rel="stylesheet" href="/css/jquery.simplecolorpicker-glyphicons.css">
    <link rel="stylesheet" href="/css/jquery.simplecolorpicker-fontawesome.css">
    <link href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <script src="/js/jquery.simplecolorpicker.js"></script>
    <script src="../js/dropzone1.js"></script>
    <script src="../js/coloursbar.js"></script>
    <script src="../js/ymap.js"></script>
    <script src="../js/ourPageScript.js"></script>


    <style>
        html, body {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;

            font-family: Arial;
        }

        #exButtRemove {
            width: 90px;
        }

        #exButtFinish {
            width: 90px;
        }

        #onlyForPaintRoute {
            position: relative;
            display: none;
            left: 70px;
        }


        .container {
            margin-right: 0;
            margin-left: 0;
        }

        #text_area {
            width: 100%;
            height: 35px;
            overflow: hidden;
            padding: 5px;
            resize: none;
        }

        #text_area_div {
            width: 170px;
            white-space: pre-wrap;
            word-wrap: break-word;
            visibility: hidden;
            position: absolute;
            left: -9999px;
        }


        #map {
            position: relative;
            top: 0%;
            left: 0%;
            widht: 100%;
            height: 100%;
            zoom: normal;
        }

        p {
            font-family: Sans-Serif;
            font-size: 12px;
            padding: 12px 0px 12px 10px;
            margin: 0px;
        }

        .navbar-text {
            position: absolute;
            top: 19%;
            left: 69.5%;
        }

        .buttons {
            font-size: 14px;
        }

        /* The switch - the box around the slider */
        .switch {
            position: absolute;
            top: 24%;
            left: 77.5%;

            display: inline-block;
            width: 60px;
            height: 34px;
        }


        /* Hide default HTML checkbox */
        .switch input {
            display: none;
        }

        /* The slider */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        .helpbtn {
            position: absolute;
            top: 50%;
            left: 84.5%;
            z-index: 10;
            zoom: 0;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 45px;
            text-align: center;
            transform-style: preserve-3d;
            perspective: 1000px;
            transform-origin: center center;
            background: transparent;
            border: none;
            outline: none;
        }

        .helpbtn-item {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
            zoom: 0;
            width: 100%;
            height: 100%;
            text-align: center;
            line-height: 45px;
            font-size: 24px;
            background-color: rgba(255, 255, 255, .05);
            transform-style: preserve-3d;
            backface-visibility: hidden;
            border-radius: 30px;
            text-transform: uppercase;
            color: #fff;
            transition: 1s;
        }

        .helpbtn-item.center {
            background: linear-gradient(to left, #c31a5b, #7129bd);
        }

        .btnflip {
            position: absolute;
            top: 50%;
            left: 93%;
            z-index: 10;
            zoom: 0;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 45px;
            text-align: center;
            transform-style: preserve-3d;
            perspective: 1000px;
            transform-origin: center center;
        }

        .btnflip-item {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
            zoom: 0;
            width: 100%;
            height: 100%;
            text-align: center;
            line-height: 45px;
            font-size: 24px;
            background-color: rgba(255, 255, 255, .05);
            transform-style: preserve-3d;
            backface-visibility: hidden;
            border-radius: 30px;
            text-transform: uppercase;
            color: #fff;
            transition: 1s;
        }

        .btnflip-item.btnflip__front {
            transform: rotateX(0deg) translateZ(20px);
        }

        .btnflip:hover .btnflip-item.btnflip__front {
            transform: rotateX(-180deg) translateZ(20px);
        }

        .btnflip-item.btnflip__back {
            transform: rotateX(180deg) translateZ(20px);
        }

        .btnflip:hover .btnflip-item.btnflip__back {
            transform: rotateX(0deg) translateZ(20px);
        }

        .btnflip-item.btnflip__center {
            background: linear-gradient(to left, #c31a5b, #7129bd);
        }

        .btnflip-item.btnflip__center::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            zoom: 0;
            z-index: 10;
            width: 100%;
            height: 100%;
            background: linear-gradient(to left, #ffdd1f, #c31a5b);
            border-radius: 30px;
            transform: translateZ(-1px);
        }

        .btnflip:hover .btnflip-item.btnflip__center {
            transform: rotateX(-180deg);
        }

        .navbar {
            position: absolute;
            top: 0;
            left: 0;
            zoom: 0;
            z-index: 10;
            width: 100%;
            height: 60px;
        }

        /*
                .navbar-brand {
                    top: 50%;
                    z-index: 10;
                    color: black;
                    font-family: ‘Raleway’, sans-serif;
                    font-size: 700px;
                    font-weight: 800;
                    line-height: 100px;
                    text-align: center;
                } */

        #text_area {
            width: 100%;
            height: 35px;
            overflow: hidden;
            padding: 5px;
            resize: none;
        }

        #text_area_div {
            width: 170px;
            white-space: pre-wrap;
            word-wrap: break-word;
            visibility: hidden;
            position: absolute;
            left: -9999px;
        }

        .stars-outer {
            position: relative;
            display: inline-block;
            margin-top: 1%;
        }

        .stars-inner {
            position: absolute;
            top: 0;
            left: 0;
            white-space: nowrap;
            overflow: hidden;
            width: 0;
        }

        .stars-outer::before {
            content: "\f005 \f005 \f005 \f005 \f005";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            color: #ccc;
        }

        .stars-inner::before {
            content: "\f005 \f005 \f005 \f005 \f005";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            color: #f8ce0b;
        }

        .my-hint {
            display: inline-block;
            padding: 10px;
            height: auto;
            position: relative;
            left: -10px;
            width: auto;
            font-size: 18px;
            line-height: 17px;
            color: grey;
            text-align: center;
            vertical-align: middle;
            background-color: #ffffff;
            border: 1px solid #CDB7B5;
            border-radius: 20px;
            font-family: Arial;
        }

        .rating-table {
            position: center;
            align-content: center;
            align-items: center;
            margin: auto;
            font-size: 16px;
            color: black;
        }

        .route-name {
            color: black;
            margin-bottom: 100px;
            font-size: 23px;
        }

        .star-rating {
            font-size: 0;
            margin-top: 3%;
        }

        .star-rating__wrap {
            display: inline-block;
            font-size: 1rem;
        }

        .star-rating__wrap:after {
            content: "";
            display: table;
            clear: both;
        }

        .star-rating__ico {
            float: right;
            padding-left: 2px;
            cursor: pointer;
            color: #f8ce0b;
        }

        .star-rating__ico:last-child {
            padding-left: 0;
        }

        .star-rating__input {
            display: none;
        }

        .star-rating__ico:hover:before,
        .star-rating__ico:hover ~ .star-rating__ico:before,
        .star-rating__input:checked ~ .star-rating__ico:before {
            content: "\f005";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
        }

        .alert-review {
            margin-top: 5%;
        }


        .route-img {
            width: 100%;
            height: 100%;
        }
    </style>

</head>
<body>

<!-- A horizontal navbar that becomes vertical on small screens -->

<nav class="navbar navbar-expand-sm navbar-light bg-light">
    <a class="navbar-brand" href="#">TouristTrapsApp</a>

    <ul class="navbar-nav mr-auto">
        <li class="nav-item" th:if="${signInData.user}">

            <div id="onlyForPaintRoute">
                Select a color:
                <select name="colorpicker-regularfont" id="initColorPalette"
                        onchange="changeColor(this.options[this.selectedIndex].value)">
                    <option value="#7bd148">Green</option>
                    <option value="#5484ed">Bold blue</option>
                    <option value="#a4bdfc">Blue</option>
                    <option value="#46d6db">Turquoise</option>
                    <option value="#7ae7bf">Light green</option>
                    <option value="#51b749">Bold green</option>
                    <option value="#fbd75b">Yellow</option>
                    <option value="#ffb878">Orange</option>
                    <option value="#ff887c">Red</option>
                    <option value="#dc2127">Bold red</option>
                    <option value="#dbadff">Purple</option>
                    <option value="#e1e1e1">Gray</option>
                </select>
                <button type="button" class="btn btn-primary" id="buttFinish" onclick="btnFinishClick()">
                    Finish
                </button>
                <button type="button" class="btn btn-secondary" id="buttCancel" onclick="buttCancelClick()">
                    Cancel
                </button>
            </div>


            <!-- Rounded switch -->

            <label class="switch">
                <input type="checkbox" id="hlpbtn" onchange="hlpbtnChange()">
                <span class="slider round"></span>
            </label>
        </li>

        <li class="navbar-text" th:if="${signInData.user}">
            Create Route
        </li>
    </ul>
    <ul class="navbar-nav ml-auto">
        <li class="nav-item">
            <div th:if="!${signInData.user}">
                <a class="btn btn-primary mt-2" href="/login">
                    Sign in
                </a>
            </div>
            <div th:unless="!${signInData.user}">
                <div>
                    <a class="btn btn-primary mt-2" id="userName" href="/logout">
                    </a>
                </div>
            </div>
        </li>
    </ul>
</nav>

<script>
    function hlpbtnChange() {
        if (($("#hlpbtn").prop("checked"))) {
            $('#onlyForPaintRoute').css("display", "block");
        } else {
            $('#onlyForPaintRoute').css("display", "none");
        }
    }
</script>

<div id="map"></div>


<script th:inline="javascript">
    let signInData = [[${signInData}]];
    let route;
    let nameText = signInData.user.userName;
    $('#userName').text(nameText);
</script>

<canvas id="draw-canvas">
</canvas>

<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&amp;apikey=9c31ef42-bb24-4bc5-9d10-5a4ec79d2433"
        type="text/javascript"></script>


<!-- Modal1 -->
<div class="modal fade" id="Modal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="Modal1Label">Route successfully added</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Большое модальное окно -->
<div class="modal fade bd-example-modal-lg" data-backdrop="static" id="myModal" tabindex="-1" role="dialog"
     aria-labelledby="myLargeModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <div class="row">
                    <p>
                    <h5>Add info about your route</h5>
                    </p>
                </div>
                <form id="jsMaster" class="needs-validation" novalidate enctype="multipart/form-data"
                      action="/">
                    <!--                          method="POST">-->
                    <div class="row">
                        <div class="col-md-8  mt-2 ">
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" placeholder="Route name"
                                       aria-label="Имя получателя" aria-describedby="basic-addon2"
                                       id="routeName" name="routeName" required minlength="3" maxlength="200"
                                       pattern="[A-Za-zА-Яа-я0-9][A-Za-zА-Яа-я0-9 -,!?)(=.;]+">
                                <div class="invalid-feedback">
                                    Please choose a route name.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-8  mt-2 ">
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" placeholder="Short description of route"
                                       aria-label="Имя получателя" aria-describedby="basic-addon2"
                                       id="shortDescription" name="shortDescription" required minlength="3"
                                       pattern="[A-Za-zА-Яа-я0-9][A-Za-zА-Яа-я0-9 -,!?)(=.;]+">
                                <div class="invalid-feedback">
                                    Please choose a short description of route
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-8  mt-2 ">
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" placeholder="Full description of route"
                                       aria-label="Имя получателя" aria-describedby="basic-addon2"
                                       id="fullDescription" name="fullDescription"
                                       pattern="[A-Za-zА-Яа-я0-9][A-Za-zА-Яа-я0-9 -,!?)(=.;]+" required minlength="3">
                                <div class="invalid-feedback">
                                    Please choose a full description of route
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="container-fluid">
                            <div class="panel panel-default" id="fileupload_main_panel">
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="dropzone" id="fileUploadForm">
                                                <span id="fileUploadStatus"> </span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-md-4 offset-md-9">
                            <button type="button" id="addRoute" class="btn btn-primary"
                                    onclick="writeRouteInDB()">
                                <!--                                data-toggle="modal">-->
                                Add route
                            </button>

                            <button type="submit" id="closeInMainModalWindow" class="btn btn-secondary"
                                    onclick="closeInMainModalWindowClick()" data-dismiss="modal">
                                Close
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- добавление в базу маршрута и валидация -->
<script>
    let youCanAddPhoto = false;

    function writeRouteInDB() {
        if ($('#jsMaster')[0].checkValidity() == true) {

            $('#hlpbtn').prop('checked', false);
            $('#onlyForPaintRoute').css("display", "none");

            youCanAddPhoto = true;

            let myObj = {
                routeName: $('#routeName').val(), routeShortDescription: $('#shortDescription').val(),
                routeFullDescription: $('#fullDescription').val(), points: fullCoord,
                color: $('#initColorPalette').val(), userID: signInData.user.userID
            };
            let json = JSON.stringify(myObj);

            fullCoord = [];

            $.ajax({
                url: 'http://localhost:8080/routes/createRoute',
                type: 'POST',
                data: {route: json},
                error: function () {
                    $('#toastOfError').toast('show');
                }
            });


        }
        $('#jsMaster')[0].classList.add('was-validated');

    }

    function closeInMainModalWindowClick() {
        Dropzone.forElement('#fileUploadForm').removeAllFiles(true);
        fullCoord = [];
        myMap.geoObjects.remove(tempRoute);
        // getRoutesFromArea(width);
    }
</script>


<!--Upload photo settings script-->
<script type="text/javascript">
    //  $(function () {
    //  Dropzone.autoDiscover = true;
    Dropzone.options.fileUploadForm = {
        url: "/",
        thumbnailWidth: 120,
        thumbnailHeight: 120,
        autoProcessQueue: false,
        //  uploadMultiple: true,
        parallelUploads: 100,
        maxFilesize: 10,
        // previewsContainer: ".dropzone-previews",
        addRemoveLinks: true,
        //resizeMimeType: 'image/jpeg',
        resizeWidth: 700,
        resizeMethod: 'contain', resizeQuality: 1.0,
        acceptedFiles: '.jpg,.jpeg,.png',
        init: function () {

            let myDropzone = this;

            $('#addRoute').on("click", function (file) {
                if (youCanAddPhoto === true) {
                    myDropzone.processQueue();
                    setTimeout(function () {

                        $('#myModal').modal('hide');

                        $('input[name=routeName]').val("");
                        $('input[name=shortDescription]').val("");
                        $('input[name=fullDescription]').val("");

                        myMap.geoObjects.remove(tempRoute);
                        newParseRouteAndDraw = true;
                        getRoutesFromArea(width);
                        newParseRouteAndDraw = false;

                        $('#toast4').toast('show');//было toast4
                        Dropzone.forElement('#fileUploadForm').removeAllFiles(true);
                    }, 3000);
                }
            });
        }

    };

</script>

<div class="modal fade" id="routeInfoModal" tabindex="-1" role="dialog" aria-labelledby="routeInfoModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="routeInfoModalLabel"></h5>

                <button type="button" id="cancelRouteInfo" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <script>  $('#cancelRouteInfo').on('click', function () {
                    $('#toggl-btn2').text("Edit my review");
                    $('#reviewService2').collapse('hide');
                });
                </script>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-4">
                        <div>Rating:</div>
                    </div>
                    <div class="col-md-auto">
                        <div class='stars-outer'>
                            <div class='stars-inner' id="routeRatingInfo"></div>
                        </div>
                    </div>
                    <div class="col-md-auto">
                        <div id="rating-num"></div>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-4">
                        <div>Short description:</div>
                    </div>
                    <div class="col-8">
                        <div id="short-desc"></div>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-4">
                        <div>Full description:</div>
                    </div>
                    <div class="col-8">
                        <div id="full-desc"></div>
                    </div>
                </div>
                <hr>

                <div class="row">
                    <div class="col-4">
                        <div>Photos:</div>
                    </div>
                </div>
                <div class="d-flex justify-content-center">
                    <div class="col-12" id="photos">

                    </div>
                </div>
                <div class="row justify-content-md-center" id="photoBtns">
                    <div class="col-md-auto">
                        <button class="btn btn-primary mt-2" id="prevPhoto">Prev</button>
                    </div>
                    <div class="col-md-auto">
                        <button class="btn btn-primary mt-2" id="nextPhoto">Next</button>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-4">
                        <div>Reviews:</div>
                    </div>
                </div>
                <div class="d-flex justify-content-center" id="noreview"></div>
                <div class="row justify-content-md-center" id="all-rev">
                    <div class="col-12">
                        <ul class="list-group">
                            <li class="list-group-item" id="list-rev-1">
                                <div class="row">
                                    <div class="col-md-5">
                                        <h8 class="mb-1" id="review-name-1"></h8>
                                    </div>
                                    <div class="col-md-4">
                                        <div class='stars-outer'>
                                            <div class='stars-inner' id="review-rate-1"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto">
                                        <h8 id="review-date-1"></h8>
                                    </div>
                                </div>
                                <div id="rev-text-1">
                                    <hr>
                                    <div class="row">
                                        <div class="col-md-auto">
                                            <h9 class="mb-1" id="review-text-1"></h9>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="list-group-item" id="list-rev-2">
                                <div class="row">
                                    <div class="col-md-5">
                                        <h8 class="mb-1" id="review-name-2"></h8>
                                    </div>
                                    <div class="col-md-4">
                                        <div class='stars-outer'>
                                            <div class='stars-inner' id="review-rate-2"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto">
                                        <h8 id="review-date-2"></h8>
                                    </div>
                                </div>
                                <div id="rev-text-2">
                                    <hr>
                                    <div class="row">
                                        <div class="col-md-auto">
                                            <h9 class="mb-1" id="review-text-2"></h9>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="list-group-item" id="list-rev-3">
                                <div class="row">
                                    <div class="col-md-5">
                                        <h8 class="mb-1" id="review-name-3"></h8>
                                    </div>
                                    <div class="col-md-4">
                                        <div class='stars-outer'>
                                            <div class='stars-inner' id="review-rate-3"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto">
                                        <h8 id="review-date-3"></h8>
                                    </div>
                                </div>
                                <div id="rev-text-3">
                                    <hr>
                                    <div class="row">
                                        <div class="col-md-auto">
                                            <h9 class="mb-1" id="review-text-3"></h9>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row justify-content-md-center" id="my-rev">
                    <div class="col-12">
                        <ul class="list-group">
                            <li class="list-group-item" id="my-revv">
                                <div class="row">
                                    <div class="col-md-5">
                                        <h8 class="mb-1" id="my-review-name"></h8>
                                    </div>
                                    <div class="col-md-4">
                                        <div class='stars-outer'>
                                            <div class='stars-inner' id="my-review-rate"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-auto">
                                        <h8 id="my-review-date"></h8>
                                    </div>
                                </div>
                                <div id="my-rev-text">
                                    <hr>
                                    <div class="row">
                                        <div class="col-md-auto">
                                            <h9 class="mb-1" id="my-review-textt"></h9>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row justify-content-md-center">
                    <div class="col-md-auto">
                        <button class="btn btn-primary mt-2" id="prev3reviews">Prev</button>
                    </div>
                    <div class="col-md-auto">
                        <button class="btn btn-primary mt-2" id="next3reviews">Next</button>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-md-12" id="add-rev-col" th:if="${signInData.user}">
                        <a class="btn btn-primary mt-2 buttons" data-toggle="collapse" href="#reviewService"
                           role="button"
                           id="toggl-btn"
                           aria-expanded="false"
                           aria-controls="reviewService">Add new review</a>
                        <div class="collapse" id="reviewService">
                            <div class="form-group mt-3" th:if="${signInData.user}">
                                <form name="reviewForm" id="routeForm" onsubmit="return false;">
                                    <div class="form-row">
                                        <div class="col-md-auto">
                                            Route mark:
                                        </div>
                                        <div class="col-md-auto">
                                            <div class="star-rating">
                                                <div class="star-rating__wrap">
                                                    <input class="star-rating__input" id="star-rating-5" type="radio"
                                                           name="rating" value="5">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-5"
                                                           title="Amazing"></label>
                                                    <input class="star-rating__input" id="star-rating-4" type="radio"
                                                           name="rating" value="4">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-4"
                                                           title="Very good"></label>
                                                    <input class="star-rating__input" id="star-rating-3" type="radio"
                                                           name="rating" value="3">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-3"
                                                           title="Good"></label>
                                                    <input class="star-rating__input" id="star-rating-2" type="radio"
                                                           name="rating" value="2">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-2"
                                                           title="Bad"></label>
                                                    <input class="star-rating__input" id="star-rating-1" type="radio"
                                                           name="rating" value="1">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-1"
                                                           title="Very bad"></label>
                                                    <input class="star-rating__input" id="star-rating-0" type="radio"
                                                           name="rating" value="0">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-0"
                                                           title="Very bad"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <textarea class="form-control" id="reviewTextArea" name="review" rows="3"
                                                  placeholder="Review text"></textarea>
                                    </div>
                                    <button class="btn btn-primary mt-2" id="addReviewBtn">
                                        Add review
                                    </button>
                                    <div class="row">
                                        <div class="col-md-auto">
                                            <div class="alert-review" id="alert_placeholder"></div>
                                        </div>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-auto" id="show-my-rev" th:if="${signInData.user}">
                        <button class="btn  btn-primary mt-2 buttons">
                            Show my review
                        </button>
                    </div>
                    <div class="col-md-4" th:if="${signInData.user}">
                        <button class="btn btn-primary mt-2 buttons" id="show-all-rev">
                            Show all reviews
                        </button>
                    </div>
                    <div class="col-md-4" th:if="${signInData.user}">
                        <button class="btn btn-primary mt-2 buttons" id="del-my-rev">
                            Delete my review
                        </button>
                    </div>

                    <!--Editing route html -->

                    <div class="col-md-4" id="change-my-rev" th:if="${signInData.user}">
                        <a class="btn btn-primary mt-2 buttons" data-toggle="collapse" href="#reviewService2"
                           role="button"
                           id="toggl-btn2"
                           aria-expanded="false"
                           aria-controls="reviewService2">Edit my review</a>
                    </div>
                </div>


                <div class="row">
                    <div class="col-md-6" th:if="${signInData.user}">
                        <button class="btn btn-primary mt-2 buttons" id="update-my-route">
                            Update/delete route
                        </button>
                    </div>
                </div>


                <div class="row justify-content-md-center">
                    <div class="col-md-12">
                        <div class="collapse" id="reviewService2">
                            <hr>
                            <div class="form-group mt-3" th:if="${signInData.user}">
                                <form name="reviewForm" id="routeForm2" onsubmit="return false;">


                                    <div class="form-row">
                                        <div class="col-md-auto">
                                            Route mark:
                                        </div>
                                        <div class="col-md-4">
                                            <div class="star-rating">
                                                <div class="star-rating__wrap">
                                                    <input class="star-rating__input" id="star-rating-52" type="radio"
                                                           name="rating" value="5">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-52"
                                                           title="Amazing"></label>
                                                    <input class="star-rating__input" id="star-rating-42" type="radio"
                                                           name="rating" value="4">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-42"
                                                           title="Very good"></label>
                                                    <input class="star-rating__input" id="star-rating-32" type="radio"
                                                           name="rating" value="3">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-32"
                                                           title="Good"></label>
                                                    <input class="star-rating__input" id="star-rating-22" type="radio"
                                                           name="rating" value="2">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-22"
                                                           title="Bad"></label>
                                                    <input class="star-rating__input" id="star-rating-12" type="radio"
                                                           name="rating" value="1">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-12"
                                                           title="Very bad"></label>
                                                    <input class="star-rating__input" id="star-rating-02" type="radio"
                                                           name="rating" value="0">
                                                    <label class="star-rating__ico fa fa-star-o fa-lg"
                                                           for="star-rating-02"
                                                           title="Very bad"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="form-row">


                                            <textarea class="form-control" id="reviewTextArea2" name="review" rows="3"
                                                      placeholder="Review text"></textarea>
                                    </div>

                                    <button class="btn btn-primary mt-2 buttons" id="addReviewBtn2">
                                        Apply
                                    </button>
                                    <div class="row">
                                        <div class="col-md-auto">
                                            <div class="alert-review" id="alert_placeholder2"></div>
                                        </div>
                                    </div>

                                </form>
                            </div>
                            <hr>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="routeEditModal" tabindex="-1" role="dialog" aria-labelledby="routeInfoModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="routeEditModalLabel">Edit info about your route</h5>

                <button type="button" id="cancelRouteEdit" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <script>  $('#update-my-route').on('click', function () {
                    $('#routeInfoModal').modal('hide');
                    $('#routeNameUPD').val(route.properties._data.routeName);
                    $('#shortDescriptionUPD').val(route.properties._data.routeShortDescription);
                    $("#fullDescriptionUPD").val(route.properties._data.routeFullDescription);
                    $('#routeEditModal').modal('show');
                    $('#toggl-btn2').text("Edit my review");
                    $('#reviewService2').collapse('hide');
                });
                </script>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12" id="upd-route-col" th:if="${signInData.user}">


                        <div class="form-group mt-3" th:if="${signInData.user}">
                            <form name="reviewForm" id="routeFormUPD" onsubmit="return false;"
                                  class="needs-validation" novalidate enctype="multipart/form-data"
                                  action="/">
                                <div class="row">
                                    <div class="col-md-12  mt-2 ">
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control" placeholder="Route name"
                                                   aria-label="Имя получателя" aria-describedby="basic-addon2"
                                                   id="routeNameUPD" name="routeName" required minlength="3"
                                                   maxlength="100"
                                                   pattern="[A-Za-zА-Яа-я0-9][A-Za-zА-Яа-я0-9 -,!?)(=.;]+">
                                            <div class="invalid-feedback">
                                                Please choose a route name.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12  mt-2 ">
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control"
                                                   placeholder="Short description of route"
                                                   aria-label="Имя получателя" aria-describedby="basic-addon2"
                                                   id="shortDescriptionUPD" name="shortDescription" required
                                                   minlength="3"
                                                   pattern="[A-Za-zА-Яа-я0-9][A-Za-zА-Яа-я0-9 -,!?)(=.;]+">
                                            <div class="invalid-feedback">
                                                Please choose a short description of route
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-12  mt-2 ">
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control"
                                                   placeholder="Full description of route"
                                                   aria-label="Имя получателя" aria-describedby="basic-addon2"
                                                   id="fullDescriptionUPD" name="fullDescription"
                                                   required minlength="3"
                                                   pattern="[A-Za-zА-Яа-я0-9][A-Za-zА-Яа-я0-9 -,!?)(=.;]+">
                                            <div class="invalid-feedback">
                                                Please choose a full description of route
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-auto">
                                        <button class="btn btn-primary mt-2" id="upd-route">
                                            Update route
                                        </button>
                                    </div>

                                    <div class="col-md-auto" th:if="${signInData.user}">
                                        <button class="btn btn-primary mt-2" id="del-my-route">
                                            Delete route
                                        </button>
                                    </div>
                                </div>
                                <script>
                                    // $('#routeService').collapse('hide');
                                    $('#update-my-route').on('click', function () {

                                        $('input[name=routeNameUPD]').val("");
                                        $('input[name=shortDescriptionUPD]').val("");
                                        $('input[name=fullDescriptionUPD]').val("");

                                    });

                                    $('#upd-route').on("click", function () {
                                        if ($('#routeFormUPD')[0].checkValidity() == true) {

                                            $.ajax({
                                                url: 'http://localhost:8080/routes/' + route.properties._data.routeID + '/updateRoute',
                                                type: 'PUT',
                                                data: {
                                                    routeName: $('#routeNameUPD').val(),
                                                    routeShortDescription: $('#shortDescriptionUPD').val(),
                                                    routeFullDescription: $('#fullDescriptionUPD').val()
                                                },
                                                success: function () {
                                                    if ($('#routeNameUPD').val() != "") {
                                                        $('#routeInfoModalLabel').text($('#routeNameUPD').val());
                                                    }
                                                    if ($('#shortDescriptionUPD').val() != "") {
                                                        $('#short-desc').text($('#shortDescriptionUPD').val());
                                                    }
                                                    if ($('#fullDescriptionUPD').val() != "") {
                                                        $('#full-desc').text($('#fullDescriptionUPD').val());
                                                    }
                                                    // $('#toggl-btn-upd-route').text("Update route info");
                                                    // $('#routeService').collapse('hide');
                                                    //
                                                },
                                                error: function () {
                                                    $('#toastOfError').toast('show');
                                                }

                                            });
                                            $('#toggl-btn-upd-route').text("Update route info");
                                            myMap.geoObjects.removeAll();
                                            youCanDeleteRoute = true;
                                            getRoutesFromArea(width);
                                            $('#routeEditModal').modal('hide');
                                            $('#toast8').toast('show');
                                        }
                                        $('#routeFormUPD')[0].classList.add('was-validated');
                                    });

                                </script>
                            </form>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<!--<div class="modal fade" id="ReviewModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"-->
<!--     aria-hidden="true">-->
<!--    <div class="modal-dialog" role="document">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <h5 class="modal-title" id="ReviewModalLabel">Review successfully added</h5>-->
<!--                <button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
<!--                    <span aria-hidden="true">&times;</span>-->
<!--                </button>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<div class="toast shadow-lg mb-2" id="toast5" style="position: absolute; top: 85%; right: 5px;"
     data-delay="5000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-primary p-2">
        <strong class="mr-auto text-light">My congratulations</strong>
        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true" style="right: 3px">&times;</span>
        </button>
    </div>
    <div class="toast-body p-2">
        Review successfully added!
    </div>
</div>

<!--<div class="modal fade" id="ReviewModalDel" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"-->
<!--     aria-hidden="true">-->
<!--    <div class="modal-dialog" role="document">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <h5 class="modal-title" id="ReviewModalDelLabel">Review successfully deleted</h5>-->
<!--                <button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
<!--                    <span aria-hidden="true">&times;</span>-->
<!--                </button>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<div class="toast shadow-lg mb-2" id="toast6" style="position: absolute; top: 85%; right: 5px;"
     data-delay="5000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-primary p-2">
        <strong class="mr-auto text-light">My congratulations</strong>
        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true" style="right: 3px">&times;</span>
        </button>
    </div>
    <div class="toast-body p-2">
        Review successfully deleted!
    </div>
</div>

<!--<div class="modal fade" id="RouteModalDel" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"-->
<!--     aria-hidden="true">-->
<!--    <div class="modal-dialog" role="document">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <h5 class="modal-title" id="RouteModalDelLabel">Route successfully deleted</h5>-->
<!--                <button type="button" class="close" data-dismiss="modal" aria-label="Close">-->
<!--                    <span aria-hidden="true">&times;</span>-->
<!--                </button>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<div class="toast shadow-lg mb-2" id="toast7" style="position: absolute; top: 85%; right: 5px;"
     data-delay="5000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-primary p-2">
        <strong class="mr-auto text-light">My congratulations</strong>
        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true" style="right: 3px">&times;</span>
        </button>
    </div>
    <div class="toast-body p-2">
        Route successfully deleted!
    </div>
</div>


<div class="modal fade" id="ReviewModalEdit" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ReviewModalEditLabel">Review successfully updated</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        </div>
    </div>
</div>

<div class="toast shadow-lg mb-2" id="toast8" style="position: absolute; top: 85%; right: 5px;"
     data-delay="5000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-primary p-2">
        <strong class="mr-auto text-light">My congratulations</strong>
        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true" style="right: 3px">&times;</span>
        </button>
    </div>
    <div class="toast-body p-2">
        Review successfully updated!
    </div>
</div>

<div class="modal fade" id="invalidRouteModal" data-backdrop="static" tabindex="-1" role="dialog"
     aria-labelledby="invalidRouteModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="invalidRouteModalLabel">Invalid distance between lines!</h5>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-primary mt-2" data-dismiss="modal">Сontinue drawing of the route
                </button>
                <button type="button" id="deleteAllLines" class="btn btn-primary mt-2" data-dismiss="modal">Delete all
                    lines
                </button>
            </div>
        </div>
    </div>
</div>

<div class="toast shadow-lg mb-2" id="toast1" style="position: absolute; top: 85%; right: 5px;"
     data-delay="5000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-primary p-2">
        <strong class="mr-auto text-light">Warning</strong>
        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true" style="right: 3px">&times;</span>
        </button>
    </div>
    <div class="toast-body p-2">
        Invalid distance between lines!
    </div>
</div>

<div class="toast shadow-lg mb-2" id="toast2" style="position: absolute; top: 85%; right: 5px;"
     data-delay="5000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-primary p-2">
        <strong class="mr-auto text-light">Warning</strong>
        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true" style="right: 3px">&times;</span>
        </button>
    </div>
    <div class="toast-body p-2">
        You should paint a route!
    </div>
</div>

<div class="toast shadow-lg mb-2" id="toast3" style="position: absolute; top: 15%; right: 5px;"
     data-delay="4000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-primary p-2">
        <!--        <strong class="mr-auto text-light">Warning</strong>-->
        <!--        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">-->
        <!--            <span aria-hidden="true" style="right: 3px">&times;</span>-->
        <!--        </button>-->
    </div>
    <div class="toast-body p-2">
        You can draw a route on the map!
    </div>
</div>

<div class="toast shadow-lg mb-2" id="toast4" style="position: absolute; top: 85%; right: 5px;"
     data-delay="5000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-primary p-2">
        <strong class="mr-auto text-light">My congratulations</strong>
        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true" style="right: 3px">&times;</span>
        </button>
    </div>
    <div class="toast-body p-2">
        Route successfully added!
    </div>
</div>

<div class="toast shadow-lg mb-2" id="toastOfError" style="position: absolute; top: 85%; right: 5px;"
     data-delay="5000" aria-live="polite" aria-atomic="true">
    <div class="toast-header bg-danger p-2">
        <strong class="mr-auto text-light">Warning</strong>
        <button type="button" class="mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true" style="right: 3px">&times;</span>
        </button>
    </div>
    <div class="toast-body p-2">
        Error occurred!
    </div>
</div>

<script>
    $('#Modal1').on('hide.bs.modal', function () {
        getRoutesFromArea(width);
    })
</script>

</body>
</html>
